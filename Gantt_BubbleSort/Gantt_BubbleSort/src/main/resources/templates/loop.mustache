<!DOCTYPE html>
<html lang="en">
  <head>
<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.9/vue.min.js"></script>
	<script src="https://export.dhtmlx.com/gantt/api.js?v=20180322"></script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" />
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>
	<script src="http://code.jquery.com/jquery-latest.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.3.1.min.js?v=5.2.4" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
 	<script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.8.7/chosen.jquery.js?v=5.2.4"></script>
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans|Roboto:regular,medium,thin,bold">
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.8.7/chosen.css?v=5.2.4">
<<<<<<< HEAD
	<script src="https://cdn.dhtmlx.com/gantt/edge/dhtmlxgantt.js"></script>	
	<link rel="stylesheet" href="https://docs.dhtmlx.com/gantt/codebase/dhtmlxgantt.css?v=6.0.0">
=======
	<script src="https://docs.dhtmlx.com/gantt/codebase/dhtmlxgantt.js?v=7.0.5"></script>
	<link rel="stylesheet" href="https://docs.dhtmlx.com/gantt/codebase/dhtmlxgantt.css?v=7.0.5">
>>>>>>> a6a1cf4946468ce38b86be73e879ebff0f79bf7b
	
	
	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
	<!-- Bootstrap JS -->
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
	<!-- Icones Fontawesome -->
	<script src="https://kit.fontawesome.com/83250a9515.js" crossorigin="anonymous"></script>
	<!-- Firebase -->
	<script src="https://www.gstatic.com/firebasejs/7.9.3/firebase.js"></script>
	<!-- React -->
	<script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
	<script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>
	<!-- JSX -->
	<script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
	

	<title>Necto - Gantt</title>
	
	<style>
			body, html {
			  height: 100%;
			  font-family: "Inconsolata", sans-serif;
			}
			
			.bgimg {
			  background-position: center;
			  background-size: cover;
			  background-image:url("/home/daniele/Desktop/tentativa/frontito/fotiras/capa.jpg");
			  min-height: 75%;
			}
			
			.menu {
			  display: none;
			}
		.chart-wrap, * { font-family: "Inconsolata", sans-serif; }
		
				 .chart-wrap {
				    background: #f3f3f6;
				  padding: 20px;
				/* height: 100%; */
				}
				  
				  
				  .gantt_task_link {
				    opacity: .2; }
				  
				  
				  .gantt_scale_cell, .gantt_task_cell {
				    border-right: 1px solid #F3F3F6; }
				  
				  .gantt_grid_data .gantt_row, .gantt_grid_data .gantt_row.odd {
				  	transition: .3s all ease-in-out;   }
				  
				  .gantt_task_line {
				  	background: #7Fbeeb;
				    border: 0px solid blue;  	}
				  
				  .gantt_task_content {
				    text-align: left !important; 
				    font-weight: bold; }
				  .gantt_grid .gantt_grid_scale .gantt_grid_head_cell {
				    text-transform: none;
					  font-weight: 800;
					  color: #C9CAD5;
				  font-size: 18px;}
				  
				  .gantt_cell[data-column-name="text"] { /* Prokect Title */
				    font-weight: bold;
				    font-size: 18px;
				  	color: #2E2C56}
				  
				  .gantt_row div:nth-child(4) { /* Subtask Title */
				    font-weight: 600;
				    font-size: 16px;
				  	color: #474469}
				  
				 .gantt_task .gantt_task_scale .gantt_scale_cell {
				   text-transform: none; } 
				  .gantt_grid_data .gantt_row.gantt_selected, .gantt_grid_data .gantt_row.odd.gantt_selected, .gantt_task_row.gantt_selected {
				    background: azure; }
				  .gantt_task_row.gantt_selected .gantt_task_cell {
				    border-right-color: rgba(145,210,210,.2); }
				  .gantt_grid_data .gantt_row:hover {
				    background-color: rgba(0,199,181,.1); }
				  .gantt_tree_icon.gantt_close {
				    width: 20px;
				    cursor: pointer;
				    padding-right: 5px; 
				    opacity: .5; }
				  div.gantt_grid_scale:after, div.gantt_scale_line:last-child:after {
				    box-shadow: none; }
				  .subtitle {
				    color: #999;
				    margin:0px 0px -10px 0px;
				    font-weight: 400;
				    font-size: 14px;
				  }
				
				.badge.badge-danger {
				  background: red;
				  color: white;
				}
			.modalDialog {
				position: fixed;
				font-family: Arial, Helvetica, sans-serif;
				top: x;
				right: 0;
				bottom: 0;
				left: 0;
				background: rgba(0,0,0,0.8);
				z-index: 99999;
				opacity:0;
				-webkit-transition: opacity 400ms ease-in;
				-moz-transition: opacity 400ms ease-in;
				transition: opacity 400ms ease-in;
				pointer-events: none;
			}
		
			.modalDialog:target {
				opacity:1;
				pointer-events: auto;
			}
		
			.modalDialog > div {
				width: 400px;
				position: relative;
				margin: 10% auto;
				padding: 5px 20px 13px 20px;
				border-radius: 10px;
				background: #fff;
				background: -moz-linear-gradient(#fff, #999);
				background: -webkit-linear-gradient(#fff, #999);
				background: -o-linear-gradient(#fff, #999);
			}
		
			.close {
				background: #606061;
				color: #FFFFFF;
				line-height: 25px;
				position: absolute;
				right: -12px;
				text-align: center;
				top: -10px;
				width: 24px;
				text-decoration: none;
				font-weight: bold;
				-webkit-border-radius: 12px;
				-moz-border-radius: 12px;
				border-radius: 12px;
				-moz-box-shadow: 1px 1px 3px #000;
				-webkit-box-shadow: 1px 1px 3px #000;
				box-shadow: 1px 1px 3px #000;
			}
		
			.close:hover { background: #00d9ff; }
			
			 .btn {
			  background-color: #000000;
			  border: none;
			  color: white;
			  padding: 12px 16px;
			  font-size: 16px;
			  cursor: pointer;
			}
			
			/* Darker background on mouse-over */
			.btn:hover {
			  background-color: #000000;
			}

			.weekend{ background: #f4f7f4 !important;}
	</style>
  </head>
  <body>
	  <!-- Links de cima --> 
		<div class="w3-top">
		  <div class="w3-row w3-padding w3-black">
		    <div class="w3-col s3">
		      <a href="/" class="w3-button w3-block w3-black">HOME</a>
		    </div>
		    <div class="w3-col s3">
		      <a href="/ganttTasks" class="w3-button w3-block w3-black">GANTT</a>
		    </div>
		    <div class="w3-col s3">
		      <a href="/devs" class="w3-button w3-block w3-black">Desenvolvedores</a>
		    </div>
		    <div class="w3-col s3">
		      <a href="https://gitlab.com/gurst6/projeto-integrador-gantt" class="w3-button w3-block w3-black">GIT</a>
		    </div>
		  </div>
		</div>
		<br>
		<br>
		<br>

		<button id="save" style="margin-left: 15px" class="btn"><i class="fa fa-folder"></i> SAVE</button>
		<br>
		<button id="func" style="margin-left: 15px" class="btn"><i class="fa fa-folder"></i> Funcionario</button>
		<br>
		<div id="gantt_here" style="width:100%; height:100%;"></div>

		<script>
			$(document).ready(function(){

				//----------------------------------------------------------------------------------
				// Carregamento dos dados ----------------------------------------------------------
				//----------------------------------------------------------------------------------
				var data = {
					"data" : [ 
						{{#projetos}}
						{
							"id" : "{{id}}",
							"text" : "{{text}}",
							"start_date" : "{{start_date}}",
							"end_date" : "{{end_date}}",
							"status" : "On Track",
							"order" : 10,
							"progress" : "{{progress}}",
							"type" : "{{type}}",
							"open" : true,
							"parent" : "{{parent}}",
							"duration" : "{{duration}}",
							"priority" : "{{priority}}"
						},
						{{/projetos}}
						{{#tarefas}}
						{
							"id" : "{{id}}",
							"text" : "{{text}}",
							"start_date" : "{{start_date}}",
							"end_date" : "{{end_date}}",
							"status" : "On Track",
							//"order" : 10,
							"progress" : "{{progress}}",
							"parent" : "{{parent}}",
							"duration" : "{{duration}}",
							"priority" : "{{priority}}",
							"type" : "{{type}}",
							"render" : "{{render}}"
						},
						{{/tarefas}}
					],
					"links" : [
						{{#links}}
						  {
						   "id":"{{id}}",
						   "source":"{{source}}",
						   "target":"{{target}}",
						   "type":"{{type}}"
					      },
						{{/links}}
					]
				};
				//----------------------------------------------------------------------------------


				//----------------------------------------------------------------------------------
				// Carregamento dos dados ----------------------------------------------------------
				//----------------------------------------------------------------------------------
				gantt.i18n.setLocale({
					date: {
						month_full: ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", 
							"Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"],
						month_short: ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", 
							"Ago", "Set", "Out", "Nov", "Dec"],
						day_full: ["Domingo", "Segunda-feira", "Terça-feira", "Quarta-feira", "Quinta-feira",
							"Sexta-feira", "Sábado"],
						day_short: ["Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sab"]
					},
					labels: {
						new_task: "Nova tarefa",
						icon_save: "Salvar",
						icon_cancel: "Cancelar",
						icon_details: "Detalhes",
						icon_edit: "Editar",
						icon_delete: "Deletar",
						gantt_save_btn: "Salvar",
						gantt_cancel_btn: "Cancelar",
						gantt_delete_btn: "Excluir",
						confirm_closing: "",// Your changes will be lost, are you sure?
						confirm_deleting: "A tarefa será excluída permanentemente. Confirmar exclusão?",
						section_description: "Descrição",
						section_time: "Período de tempo",
						section_type: "Tipo",
				
						/* grid columns */
						column_wbs: "WBS",
						column_text: "Nome da tarefa",
						column_start_date: "Hora de início",
						column_duration: "Duração",
						column_add: "",
				
						/* link confirmation */
						link: "Link",
						confirm_link_deleting: "Será excluído",
						link_start: " (Começo)",
						link_end: " (Fim)",
				
						type_task: "Tarefa",
						type_project: "Projeto",
						type_milestone: "Marco",
				
						minutes: "Minutos",
						hours: "Horas",
						days: "Dias",
						weeks: "Semanas",
						months: "Meses",
						years: "Anos",
				
						/* message popup */
						message_ok: "OK",
						message_cancel: "Cancelar",
				
						/* constraints */
						section_constraint: "Constante",
						constraint_type: "Tipo de Constante",
						constraint_date: "Data da Constante",
						asap: "Assim que possível",
						alap: "Mais tarde possível",
						snet: "Não iniciar antes de",
						snlt: "Não iniciar depois de",
						fnet: "Não terminar antes de",
						fnlt: "Não terminar depois de",
						mso: "Deve começar em",
						mfo: "Deve terminar em",
				
						/* resource control */
						resources_filter_placeholder: "Digite para filtrar",
						resources_filter_label: "Esconder vazios"
					}
				});
				//----------------------------------------------------------------------------------

				gantt.config.work_time = true;
				
				gantt.templates.scale_cell_class = function(date){
					if(!gantt.isWorkTime(date)){
						return "weekend";
					}
				};
				gantt.templates.timeline_cell_class = function(task,date){
					if(!gantt.isWorkTime({task:task, date:date})){
						return "weekend" ;
					}
				};
	

				/*var formatter = gantt.ext.formatters.durationFormatter({
									enter: "day", 
									store: "minute", // duration_unit
									format: "day",
									hoursPerDay: 8,
									hoursPerWeek: 40,
									daysPerMonth: 30
								});*/

				var formatter = gantt.ext.formatters.durationFormatter({
									enter: "hour", 
									store: "hour", // duration_unit
									format: "hour"
								});
				
				gantt.config.columns = [ {
					name : "text",
					label : "Projetos",
					tree : true,
					width : '*',
					template : RowTitle
				}, {
<<<<<<< HEAD
					name:"Programadores", label:"Resources",  tree:true, width:180, template: function(task){
   				       	return task.resources;
    			} }, {
=======
					name: "start_date", label: "Início"
				}, {
>>>>>>> a6a1cf4946468ce38b86be73e879ebff0f79bf7b
				 	name : "add"
				}];
				
				
				//----------------------------------------------------------------------------------
				// Configuração das telas de crud --------------------------------------------------
				//----------------------------------------------------------------------------------
				var userMap = [  
					      { key: 1, label: "Gabriel", unit: "hours" },    
					      { key: 2, label: "Gustavo", unit: "hours" },   
					      { key: 3, label: "Cadu", unit: "hours" }   
					    ]
				
				gantt.config.lightbox.sections = [
					{name: "type", type: "typeselect", map_to: "type"},
					{name:"priority", height:22, map_to:"priority", type:"select", options: [ 
						{key:1, label: "High"},                                               
						{key:2, label: "Normal"},                                             
						{key:3, label: "Low"}                                                 
					]},
					{name:"description", height:38, map_to:"text", type:"textarea", focus:true},
        			{name:"Programadores: ",type:"resources",map_to:"owner_id", options: userMap}, 
        			{name: "time", type: "duration", map_to: "auto", formatter: formatter},
					{name: "split", type:"checkbox", map_to: "render", options:[
						{key:"split", label:"Split Task"}
					]}
				];				

				gantt.config.lightbox.project_sections = [
					{name: "type", type: "typeselect", map_to: "type"},
					{name:"priority", height:22, map_to:"priority", type:"select", options: [ 
						{key:1, label: "High"},                                               
						{key:2, label: "Normal"},                                             
						{key:3, label: "Low"}                                                 
					]},
					{name:"description", height:38, map_to:"text", type:"textarea", focus:true},
					{name: "split", type:"checkbox", map_to: "render", options:[
						{key:"split", label:"Split Task"}
					]}
				];	

				gantt.config.lightbox.milestone_sections = [
					{name: "type", type: "typeselect", map_to: "type"},
					{name:"description", height:38, map_to:"text", type:"textarea", focus:true},
					{name: "split", type:"checkbox", map_to: "render", options:[
						{key:"split", label:"Split Task"}
					]}
				];	
				// ------------------------------------------------------------------------------
				
				gantt.config.work_time = true;  // removes non-working time from calculations 
				//gantt.config.skip_off_time = true;
				gantt.config.duration_unit = "hour";
				//gantt.config.show_tasks_outside_timescale = true;

				gantt.config.drag_project = true;
				
				var RowTitle = function(obj) {
					return ('<h3 style=\"line-height:14px;color:#0b0839;margin:5px 0px -10px 0px;\">Title</h3><p class=\"subtitle\">small subtitle</p>');
				}
				

				gantt.config.row_height = 50
			
				//gantt.config.scroll_size = 20;
			
				gantt.config.scale_unit = "month";
				gantt.config.date_scale = "%Y";
				//gantt.config.min_column_width = 50;
			
				gantt.config.scale_height = 70;
			
				var weekScaleTemplate = function(date) {
					var dateToStr = gantt.date.date_to_str("%d %M");
					var endDate = gantt.date.add(gantt.date.add(date, 1, "week"), -1, "day");
					return dateToStr(date) + " - " + dateToStr(endDate);
				};
			
				var daysStyle = function(date) {
					var dateToStr = gantt.date.date_to_str("%D");
					if (dateToStr(date) == "Sun" || dateToStr(date) == "Sat")
						return "weekend";
			
					return "";
				};
			

				var hourToStr = gantt.date.date_to_str("%H:%i");
				var hourRangeFormat = function(step){
					return function(date){
						var intervalEnd = new Date(gantt.date.add(date, step, "hour") - 1)
						return hourToStr(date) + " - " + hourToStr(intervalEnd);
					};
				};

				gantt.config.subscales = [  {
					unit : "day",
					step : 1,
					date : "Dia %d - %M"
				}, {
					unit : "hour",
					step : 1,
					date : "%Hh"
				} ];
				

				

				var zoomConfig = {
					levels: [
					{
						name:"day",
						//scale_height: 27,
						min_column_width:80,
						scales:[
							{unit: "day", step: 1, format: "%d %M"}
						]
					},
					{
						name:"week",
						//scale_height: 50,
						min_column_width:50,
						scales:[
						{unit: "week", step: 1, format: function (date) {
						var dateToStr = gantt.date.date_to_str("%d %M");
						var endDate = gantt.date.add(date, -6, "day");
						var weekNum = gantt.date.date_to_str("%W")(date);
						return "#" + weekNum + ", " + dateToStr(date) + " - " + dateToStr(endDate);
						}},
						{unit: "day", step: 1, format: "%j %D"}
						]
					},
					{
						name:"month",
						//scale_height: 50,
						min_column_width:120,
						scales:[
							{unit: "month", format: "%F, %Y"},
							{unit: "week", format: "Week #%W"}
						]
						},
						{
						name:"quarter",
						//height: 50,
						min_column_width:90,
						scales:[
						{unit: "month", step: 1, format: "%M"},
						{
						unit: "quarter", step: 1, format: function (date) {
							var dateToStr = gantt.date.date_to_str("%M");
							var endDate = gantt.date.add(gantt.date.add(date, 3, "month"), -1, "day");
							return dateToStr(date) + " - " + dateToStr(endDate);
						}
						}
						]},
						{
						name:"year",
						//scale_height: 50,
						min_column_width: 30,
						scales:[
							{unit: "year", step: 1, format: "%Y"}
						]}
					],
					useKey: "ctrlKey",
									trigger: "wheel",
									element: function(){
										return gantt.$root.querySelector(".gantt_task");
									}
				};

	gantt.ext.zoom.init(zoomConfig);
	gantt.init("gantt_here");
								
				gantt.parse(data);				    

				$("#save").click(function() {
					
				// PREPARE FORM DATA
					var formData = JSON.stringify(gantt.serialize());
					
					// DO POST
					jQuery.ajax ({
						url: "/salvar",
						type: "POST",
						data: formData,
						dataType: "json",
						contentType: "application/json; charset=utf-8",
						success: function(){
							alert("Success!")
							
						}
					});
				});
				
				$("#func").click(function() {

				// PREPARE FORM DATA
					var funcData = JSON.stringify(userMap);
					
					// DO POST
					jQuery.ajax ({
						url: "/funcionario",
						type: "POST",
						data: funcData,
						dataType: "json",
						contentType: "application/json; charset=utf-8",
						success: function(){
							alert("Success!")
							
						}
					});
				});
			});
		</script>
		
		<!-- Rodapé -->
		<footer class="w3-center w3-light-grey w3-padding-48 w3-large">
		  <p>Powered by Bubble Sort</p>
		  <p><center>Members: Gabriel Queiroz e Gustavo Ribeiro.<br> Master: Gabriel Queiroz </center></p>
		</footer>

</body>
</html>